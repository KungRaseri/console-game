<UserControl
        x:Class="Game.ContentBuilder.Views.NameListEditorView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:models="clr-namespace:Game.ContentBuilder.Models"
        d:DesignHeight="600"
        d:DesignWidth="1200"
        mc:Ignorable="d">
        <UserControl.Resources>
                <!-- Component Item Template -->
                <DataTemplate x:Key="ComponentItemTemplate">
                        <materialDesign:Card Margin="4,4,4,8" Padding="0">
                                <Grid>
                                        <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <!-- Header with Value, Weight, and Material Reference -->
                                        <Border Grid.Row="0" Background="{DynamicResource MaterialDesignPaper}" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="12,8">
                                                <Grid>
                                                        <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        
                                                        <!-- First Row: Value and Weight -->
                                                        <Grid Grid.Row="0">
                                                                <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="*"/>
                                                                        <ColumnDefinition Width="100"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                </Grid.ColumnDefinitions>
                                                                
                                                                <TextBox Grid.Column="0"
                                                                         Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                                         BorderThickness="0"
                                                                         FontSize="14"
                                                                         FontWeight="SemiBold"
                                                                         VerticalAlignment="Center"
                                                                         Margin="0,0,12,0"/>
                                                                
                                                                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                                                        <TextBlock Text="Weight:" Margin="0,0,6,0" VerticalAlignment="Center" FontSize="11" Foreground="Gray"/>
                                                                        <TextBox Text="{Binding RarityWeight, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                                                 Width="50"
                                                                                 BorderThickness="0,0,0,1"
                                                                                 Padding="4,2"
                                                                                 HorizontalContentAlignment="Right"
                                                                                 FontSize="13"
                                                                                 VerticalAlignment="Center"/>
                                                                </StackPanel>
                                                                
                                                                <Button Grid.Column="2"
                                                                        Command="{Binding DataContext.RemoveComponentCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                                        CommandParameter="{Binding}"
                                                                        Style="{StaticResource MaterialDesignIconButton}"
                                                                        Width="28" Height="28"
                                                                        Padding="0"
                                                                        Margin="8,0,0,0"
                                                                        ToolTip="Remove this component">
                                                                        <materialDesign:PackIcon Kind="Close" Width="16" Height="16"/>
                                                                </Button>
                                                        </Grid>
                                                        
                                                        <!-- Second Row: Material Reference -->
                                                        <Grid Grid.Row="1" Margin="0,8,0,0">
                                                                <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="*"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                </Grid.ColumnDefinitions>
                                                                
                                                                <TextBox Grid.Column="0"
                                                                         Text="{Binding MaterialRef, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                         materialDesign:HintAssist.Hint="Material Reference (e.g., materials/metals/Iron)"
                                                                         FontSize="11"
                                                                         FontFamily="Consolas"
                                                                         Margin="0,0,8,0"
                                                                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                                                         materialDesign:TextFieldAssist.UnderlineBrush="{DynamicResource PrimaryHueMidBrush}"/>
                                                                
                                                                <Button Grid.Column="1"
                                                                        Command="{Binding DataContext.BrowseMaterialCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                                        CommandParameter="{Binding}"
                                                                        Style="{StaticResource MaterialDesignIconButton}"
                                                                        Width="28" Height="28"
                                                                        Padding="0"
                                                                        ToolTip="Browse materials catalog">
                                                                        <materialDesign:PackIcon Kind="FolderOpen" Width="16" Height="16"/>
                                                                </Button>
                                                        </Grid>
                                                </Grid>
                                        </Border>
                                        
                                        <!-- Traits Section -->
                                        <StackPanel Grid.Row="1" Margin="12,8,12,12">
                                                <Grid Margin="0,0,0,8">
                                                        <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        
                                                        <materialDesign:PackIcon Grid.Column="0" Kind="TagMultiple" Width="16" Height="16" Margin="0,0,8,0" VerticalAlignment="Center" Foreground="Gray"/>
                                                        <TextBlock Grid.Column="1" Text="Traits" FontSize="11" FontWeight="SemiBold" Foreground="Gray" VerticalAlignment="Center"/>
                                                        <Button Grid.Column="2"
                                                                Command="{Binding DataContext.AddComponentTraitCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                                CommandParameter="{Binding}"
                                                                Style="{StaticResource MaterialDesignIconButton}"
                                                                Width="20" Height="20"
                                                                Padding="0"
                                                                ToolTip="Add trait">
                                                                <materialDesign:PackIcon Kind="Plus" Width="14" Height="14"/>
                                                        </Button>
                                                </Grid>
                                                
                                                <ItemsControl ItemsSource="{Binding Traits}">
                                                        <ItemsControl.ItemTemplate>
                                                                <DataTemplate>
                                                                        <Border Background="#F5F5F5" CornerRadius="4" Padding="8,6" Margin="0,0,0,4">
                                                                                <Grid>
                                                                                        <Grid.ColumnDefinitions>
                                                                                                <ColumnDefinition Width="*"/>
                                                                                                <ColumnDefinition Width="*"/>
                                                                                                <ColumnDefinition Width="80"/>
                                                                                                <ColumnDefinition Width="Auto"/>
                                                                                        </Grid.ColumnDefinitions>
                                                                                        
                                                                                        <TextBox Grid.Column="0"
                                                                                                 Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"
                                                                                                 materialDesign:HintAssist.Hint="Trait Name"
                                                                                                 FontSize="11"
                                                                                                 Margin="0,0,4,0"
                                                                                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                                                                                 materialDesign:TextFieldAssist.UnderlineBrush="{DynamicResource PrimaryHueMidBrush}"/>
                                                                                        
                                                                                        <TextBox Grid.Column="1"
                                                                                                 Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}"
                                                                                                 materialDesign:HintAssist.Hint="Value"
                                                                                                 FontSize="11"
                                                                                                 Margin="4,0,4,0"
                                                                                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                                                                                 materialDesign:TextFieldAssist.UnderlineBrush="{DynamicResource PrimaryHueMidBrush}"/>
                                                                                        
                                                                                        <ComboBox Grid.Column="2"
                                                                                                  SelectedItem="{Binding Type, UpdateSourceTrigger=PropertyChanged}"
                                                                                                  FontSize="11"
                                                                                                  Margin="4,0,4,0"
                                                                                                  materialDesign:HintAssist.Hint="Type"
                                                                                                  Style="{StaticResource MaterialDesignOutlinedComboBox}">
                                                                                                <ComboBoxItem Content="number"/>
                                                                                                <ComboBoxItem Content="boolean"/>
                                                                                                <ComboBoxItem Content="string"/>
                                                                                        </ComboBox>
                                                                                        
                                                                                        <Button Grid.Column="3"
                                                                                                Command="{Binding DataContext.RemoveComponentTraitCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                                                                CommandParameter="{Binding}"
                                                                                                Style="{StaticResource MaterialDesignIconButton}"
                                                                                                Width="20" Height="20"
                                                                                                Padding="0"
                                                                                                ToolTip="Remove trait">
                                                                                                <materialDesign:PackIcon Kind="Close" Width="12" Height="12"/>
                                                                                        </Button>
                                                                                </Grid>
                                                                        </Border>
                                                                </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                        </StackPanel>
                                </Grid>
                        </materialDesign:Card>
                </DataTemplate>
                
                <!-- Component Group Template for TreeView -->
                <HierarchicalDataTemplate x:Key="ComponentGroupTemplate" ItemsSource="{Binding Value}" ItemTemplate="{StaticResource ComponentItemTemplate}">
                        <Border Background="Transparent" Padding="4">
                                <Grid>
                                        <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                                                <materialDesign:PackIcon Kind="FolderOutline" Width="18" Height="18" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                                <TextBlock Text="{Binding Key}" FontWeight="SemiBold" FontSize="14" VerticalAlignment="Center"/>
                                                <TextBlock Text="{Binding Value.Count, StringFormat=' ({0})'}" FontSize="12" Foreground="Gray" Margin="4,0,0,0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        
                                        <Button Grid.Column="1"
                                                Command="{Binding DataContext.AddComponentCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                CommandParameter="{Binding Key}"
                                                Style="{StaticResource MaterialDesignIconButton}"
                                                Width="24" Height="24"
                                                Padding="0"
                                                ToolTip="Add component to this group">
                                                <materialDesign:PackIcon Kind="Plus" Width="16" Height="16"/>
                                        </Button>
                                        
                                        <Button Grid.Column="2"
                                                Command="{Binding DataContext.RemoveComponentGroupCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                CommandParameter="{Binding Key}"
                                                Style="{StaticResource MaterialDesignIconButton}"
                                                Width="24" Height="24"
                                                Padding="0"
                                                ToolTip="Remove this group">
                                                <materialDesign:PackIcon Kind="Delete" Width="16" Height="16"/>
                                        </Button>
                                </Grid>
                        </Border>
                </HierarchicalDataTemplate>
                
                <!-- Pattern Template with Examples -->
                <DataTemplate x:Key="PatternItemTemplate">
                        <materialDesign:Card Margin="0,0,0,8" Padding="12">
                                <Grid>
                                        <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        
                                        <Grid Grid.Row="0">
                                                <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="70"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <TextBox 
                                                        Grid.Column="0"
                                                        FontFamily="Consolas"
                                                        FontSize="13"
                                                        Text="{Binding PatternTemplate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        Margin="0,0,8,0"
                                                        materialDesign:HintAssist.Hint="Pattern template"/>
                                                
                                                <TextBox 
                                                        Grid.Column="1"
                                                        Text="{Binding Weight, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        HorizontalContentAlignment="Center"
                                                        materialDesign:HintAssist.Hint="Weight"/>
                                        </Grid>
                                        
                                        <TextBlock 
                                                Grid.Row="1"
                                                Text="{Binding Description}" 
                                                Style="{StaticResource MaterialDesignBody2TextBlock}"
                                                Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                TextWrapping="Wrap"
                                                Margin="0,6,0,0"
                                                FontSize="11"/>
                                        
                                        <!-- Example Generated Names -->
                                        <Border Grid.Row="2" 
                                                Background="#F5F5F5" 
                                                CornerRadius="4" 
                                                Padding="8,6"
                                                Margin="0,8,0,0">
                                                <StackPanel>
                                                        <TextBlock Text="Examples:" FontSize="10" FontWeight="SemiBold" Foreground="Gray" Margin="0,0,0,4"/>
                                                        <TextBlock Text="{Binding GeneratedExamples}" FontSize="11" FontFamily="Consolas" Foreground="#555" TextWrapping="Wrap"/>
                                                </StackPanel>
                                        </Border>
                                </Grid>
                        </materialDesign:Card>
                </DataTemplate>
        </UserControl.Resources>
        
        <Grid>
                <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!--  Collapsible Metadata Header  -->
                <Expander Grid.Row="0" 
                          IsExpanded="False"
                          materialDesign:ExpanderAssist.HorizontalHeaderPadding="16,12"
                          Background="{DynamicResource MaterialDesignPaper}"
                          Margin="0,0,0,8">
                        <Expander.Header>
                                <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="InformationOutline" Width="20" Height="20" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                        <TextBlock Text="METADATA" FontWeight="SemiBold" FontSize="13" VerticalAlignment="Center"/>
                                </StackPanel>
                        </Expander.Header>
                        <Grid Margin="16">
                                <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBox Grid.Row="0" Grid.Column="0"
                                         Margin="0,0,8,12"
                                         FontSize="12"
                                         materialDesign:HintAssist.Hint="Description"
                                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                         Text="{Binding Metadata.Description, UpdateSourceTrigger=PropertyChanged}"/>
                                
                                <TextBox Grid.Row="0" Grid.Column="1"
                                         Margin="8,0,0,12"
                                         FontSize="12"
                                         materialDesign:HintAssist.Hint="Type"
                                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                         Text="{Binding Metadata.Type, UpdateSourceTrigger=PropertyChanged}"/>
                                
                                <TextBox Grid.Row="1" Grid.Column="0"
                                         Margin="0,0,8,12"
                                         FontSize="12"
                                         materialDesign:HintAssist.Hint="Version"
                                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                         Text="{Binding Metadata.Version, UpdateSourceTrigger=PropertyChanged}"/>
                                
                                <TextBox Grid.Row="1" Grid.Column="1"
                                         Margin="8,0,0,12"
                                         FontSize="12"
                                         materialDesign:HintAssist.Hint="Last Modified"
                                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                         Text="{Binding Metadata.LastModified, UpdateSourceTrigger=PropertyChanged}"/>
                                
                                <TextBox Grid.Row="2" Grid.Column="0"
                                         Margin="0,0,8,12"
                                         FontSize="12"
                                         materialDesign:HintAssist.Hint="Rarity System"
                                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                         Text="{Binding Metadata.RaritySystem, UpdateSourceTrigger=PropertyChanged}"/>
                                
                                <TextBox Grid.Row="2" Grid.Column="1"
                                         Margin="8,0,0,12"
                                         FontSize="12"
                                         materialDesign:HintAssist.Hint="Usage"
                                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                         Text="{Binding Metadata.Usage, UpdateSourceTrigger=PropertyChanged}"/>
                                
                                <TextBox Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2"
                                         Margin="0,0,0,0"
                                         FontSize="12"
                                         materialDesign:HintAssist.Hint="Notes"
                                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                         AcceptsReturn="True"
                                         Height="80"
                                         VerticalScrollBarVisibility="Auto"
                                         Text="{Binding Metadata.NotesText, UpdateSourceTrigger=PropertyChanged}"/>
                        </Grid>
                </Expander>

                <!--  Two Column Layout: Components (Left) and Patterns (Right)  -->
                <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="1*"/>
                        </Grid.ColumnDefinitions>

                        <!--  Components (Left) with TreeView  -->
                        <materialDesign:Card Grid.Column="0" Margin="0,0,4,0" Padding="0">
                                <Grid>
                                        <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        
                                        <Border Grid.Row="0" Background="{DynamicResource MaterialDesignPaper}" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="16,12">
                                <Grid>
                                        <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                                                <materialDesign:PackIcon Kind="PackageVariant" Width="20" Height="20" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                                <TextBlock Text="COMPONENTS" FontWeight="Bold" FontSize="14" VerticalAlignment="Center"/>
                                                <TextBlock Text="{Binding Components.Count, StringFormat=' ({0} groups)'}" FontSize="12" Foreground="Gray" Margin="4,0,0,0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        
                                        <Button Grid.Column="2"
                                                Command="{Binding AddComponentGroupCommand}"
                                                Style="{StaticResource MaterialDesignIconButton}"
                                                ToolTip="Add new component group">
                                                <materialDesign:PackIcon Kind="Plus"/>
                                        </Button>
                                </Grid>
                        </Border>
                                        
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <TreeView ItemsSource="{Binding Components}"
                                          ItemTemplate="{StaticResource ComponentGroupTemplate}"
                                          BorderThickness="0">
                                        <TreeView.ItemContainerStyle>
                                                <Style TargetType="TreeViewItem" BasedOn="{StaticResource MaterialDesignTreeViewItem}">
                                                        <Setter Property="IsExpanded" Value="False"/>
                                                </Style>
                                        </TreeView.ItemContainerStyle>
                                </TreeView>
                        </ScrollViewer>
                </Grid>
                        </materialDesign:Card>

                        <!--  Patterns (Right)  -->
                        <materialDesign:Card Grid.Column="1" Margin="4,0,0,0" Padding="0">
                                <Grid>
                                        <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>
                                        
                                        <Border Grid.Row="0" Background="{DynamicResource MaterialDesignPaper}" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="16,12">
                                <Grid>
                                        <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                                                <materialDesign:PackIcon Kind="Puzzle" Width="20" Height="20" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                                <TextBlock Text="PATTERNS" FontWeight="Bold" FontSize="14" VerticalAlignment="Center"/>
                                                <TextBlock Text="{Binding Patterns.Count, StringFormat=' ({0})'}" FontSize="12" Foreground="Gray" Margin="4,0,0,0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        
                                        <Button Grid.Column="2"
                                                Command="{Binding RemovePatternCommand}"
                                                Style="{StaticResource MaterialDesignIconButton}"
                                                ToolTip="Remove selected pattern"
                                                Margin="0,0,4,0">
                                                <materialDesign:PackIcon Kind="Minus"/>
                                        </Button>
                                        
                                        <Button Grid.Column="3"
                                                Command="{Binding AddPatternCommand}"
                                                Style="{StaticResource MaterialDesignIconButton}"
                                                ToolTip="Add new pattern">
                                                <materialDesign:PackIcon Kind="Plus"/>
                                        </Button>
                                </Grid>
                        </Border>
                                        
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="12">
                                <ListBox ItemsSource="{Binding Patterns}"
                                         SelectedItem="{Binding SelectedPattern}"
                                         ItemTemplate="{StaticResource PatternItemTemplate}"
                                         BorderThickness="0"
                                         Background="Transparent"/>
                        </ScrollViewer>
                </Grid>
                        </materialDesign:Card>
                </Grid>

                <!--  Status Bar  -->
                <Border Grid.Row="2"
                        Background="{DynamicResource MaterialDesignPaper}"
                        BorderBrush="#E0E0E0"
                        BorderThickness="0,1,0,0"
                        Padding="16,8">
                        <Grid>
                                <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0"
                                           VerticalAlignment="Center"
                                           FontSize="12"
                                           Text="{Binding StatusMessage}"/>
                                
                                <Button Grid.Column="1"
                                        Command="{Binding SaveCommand}"
                                        Content="SAVE CHANGES"
                                        Style="{StaticResource MaterialDesignRaisedButton}"/>
                        </Grid>
                </Border>
        </Grid>
</UserControl>
